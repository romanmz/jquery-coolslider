/*! coolSlider v1.03 - http://github.com/romanmz/coolSlider */
(function(e,t,n){function o(){var e=document.createElement("p"),r,i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var s in i){if(e.style[s]!==n){e.style[s]="translate3d(1px,1px,1px)";r=t.getComputedStyle(e).getPropertyValue(i[s])}}document.body.removeChild(e);return r!==n&&r.length>0&&r!=="none"}function u(){var e=document.createElement("p").style;var t="transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e;return t}var r="1.03";var i="coolSlider";var s={type:"fade",slides:"> *",timer:8e3,speed:500,showFirst:"random",visualTimer:false,loop:false,autoplay:false,keyboard:true,swipe:"scroll",fixHeight:false,selectedSlideClass:"selected",previousSlideClass:"previous",controlsDisabledClass:"disabled",controlsPausedClass:"paused",controlsSelectedClass:"selected",addControls:true,controls:'<div class="coolSlider-controls"><h3>Slideshow controls</h3><p>Currently showing slide {{current}} of {{total}}</p/><ul>{{prevLink}}{{playLink}}{{pauseLink}}{{nextLink}}</ul><ol>{{navLinks}}</ol></div>',prevLink:'<li class="coolSlider-controls-prev"><a href="#">«<span class="default-text"> Previous slide</span><span class="alt-text"> Showing first slide</span></a></li>',nextLink:'<li class="coolSlider-controls-next"><a href="#"><span class="default-text">Next slide </span><span class="alt-text">Showing last slide </span>»</a></li>',playLink:'<li class="coolSlider-controls-play"><a href="#">▶<span> Play slideshow</span></a></li>',pauseLink:'<li class="coolSlider-controls-pause"><a href="#">■<span> Pause slideshow</span></a></li>',navLinks:'<li class="coolSlider-controls-number"><a href="#"><span class="default-text">Show slide </span><span class="alt-text">Showing slide </span>{{title}}</a></li>',init:function(){},slidestart:function(){},slideend:function(){},touchstart:function(){},touchmove:function(){},touchend:function(){},swipesuccess:function(){},swipefail:function(){}};var a=function(t,n){this.element=t;this.options=e.extend({},e.fn[i].defaults,n,t.data(i.toLowerCase()));this._init(t,this.options)};e.fn[i]=function(t){return this.each(function(){if(!e(this).data(i+"API")){e(this).data(i+"API",new a(e(this),t))}})};e.fn[i].defaults=s;a.prototype={_init:function(n,r){var s=this;var a;var f;var l;a=s.slides=n.find(r.slides);if(a.length<2){return}f=s.data={total:a.length,selected:-1,previous:-1,loopDir:0,moving:false,timerChange:false,timerTransition:false,forced:false,speed:r.speed,playing:r.autoplay,touch:"ontouchstart"in t||navigator.msMaxTouchPoints>0,selectedSlide:e(),previousSlide:e(),otherSlides:e(),visualTimer:r.visualTimer?e(r.visualTimer):e(),csstransforms3d:typeof Modernizr!="undefined"&&Modernizr.csstransforms3d||o(),csstransitions:typeof Modernizr!="undefined"&&Modernizr.csstransitions||u()};if(r.showFirst=="random"){r.showFirst=Math.ceil(Math.random()*f.total)}if(r.keyboard){e(document).on("keydown."+i,function(e){var t=e.which;if(t==37)s.showPrevious();else if(t==39)s.showNext()})}s.addTouchEvents();l=f.touch&&typeof r.swipe=="string"?r.swipe:r.type;if(typeof l==="string"&&typeof e.fn[i].transitions[l]==="function"){l=e.fn[i].transitions[l]}else if(typeof l!=="function"){e.error(i+"(): type of slider is not defined")}l.call(s,n,a,r,f);r.init.call(s,n,a,r,f);s.createControls();s.showSlide(r.showFirst-1,0);if(r.fixHeight){function c(){var t=0;a.height("").each(function(){t=Math.max(t,e(this).height())}).height(t)}c();setTimeout(c,500);e(t).on("load."+i,c);e(t).on("resize."+i,c);if(typeof e.fn.imagesLoaded=="function"){a.imagesLoaded().progress(c)}}},addTouchEvents:function(){var e=this,t=e.element,r=e.slides,s=e.options,o=e.data;var u=o.touchData={};if(!o.touch){return}t.on("touchstart."+i,function(i){var a=i.originalEvent.touches[0];u.startX=a.pageX;u.startY=a.pageY;u.startTime=+(new Date);u.deltaX=0;u.deltaY=0;u.resistance=1;u.isVertical=n;u.width=t.innerWidth();u.swipeX=0;s.touchstart.call(e,t,r,s,o)}).on("touchmove."+i,function(n){n=n.originalEvent;if(n.touches.length>1||n.scale&&n.scale!==1){return}u.deltaX=n.touches[0].pageX-u.startX;u.deltaY=n.touches[0].pageY-u.startY;if(typeof u.isVertical=="undefined"){u.isVertical=Math.abs(u.deltaX)<Math.abs(u.deltaY)}if(u.isVertical){return}if(o.selected<=0&&u.deltaX>0||o.selected>=o.total-1&&u.deltaX<0){u.resistance=Math.abs(u.deltaX)/u.width+2}u.swipeX=u.deltaX/u.width;n.preventDefault();s.touchmove.call(e,t,r,s,o)}).on("touchend."+i,function(n){if(u.isVertical){return}var a=+(new Date)-u.startTime<250;var f=Math.abs(u.deltaX)>20;var l=Math.abs(u.swipeX)>.5;if(l||a&&f){t.trigger("swipesuccess."+i);s.swipesuccess.call(e,t,r,s,o)}else{t.trigger("swipefail."+i);s.swipefail.call(e,t,r,s,o)}s.touchend.call(e,t,r,s,o)})},createControls:function(){if(this.controls||!this.options.addControls){return}var t=this,n=t.options,r=t.data;var s={controls:"",prevLink:"",nextLink:"",playLink:"",pauseLink:"",navLinks:""};var o;var u;for(var a in s){s[a]=n[a].replace(/\{\{([^}]+)\}\}/g,'<span data-replace-with="$1">$1</span>')}t.controls=o=e(s.controls);for(var a in s){switch(a){case"prevLink":case"nextLink":case"playLink":case"pauseLink":o[a]=e(s[a]);o.find('[data-replace-with="'+a+'"]').replaceWith(o[a]);break}}if(!r.playing){o.playLink.addClass(n.controlsPausedClass);o.pauseLink.addClass(n.controlsPausedClass)}u=e();for(var f=1;f<=r.total;f++){var l=e(s["navLinks"]);var c=t.slides.eq(f-1).data("slide-title");if(!c)c=f;l.find("[data-replace-with=title]").text(c).contents().unwrap();l.find("[data-replace-with=number]").text(f).contents().unwrap();u=u.add(l)}o.find('[data-replace-with="navLinks"]').replaceWith(u);o.navLinks=u;switch(n.addControls){case true:n.addControls="before";case"before":case"after":case"prepend":case"append":t.element[n.addControls](o);break;default:e(n.addControls).append(o);break}t.element.on("slidestart."+i,function(){t.updateControls()});o.prevLink.find("a").on("click."+i,function(){t.showPrevious();return false});o.nextLink.find("a").on("click."+i,function(){t.showNext();return false});o.playLink.find("a").on("click."+i,function(){t.playSlides();return false});o.pauseLink.find("a").on("click."+i,function(){t.stopSlides();return false});o.navLinks.find("a").on("click."+i,function(){r.loopDir=0;t.showSlide(t.controls.navLinks.children("a").index(e(this)));return false})},updateControls:function(){var e=this,t=e.data,n=e.options,r=e.controls;var i=n.loop||t.selected>0?"removeClass":"addClass";r.prevLink[i](n.controlsDisabledClass);var s=n.loop||t.selected<t.total-1?"removeClass":"addClass";r.nextLink[s](n.controlsDisabledClass);r.navLinks.removeClass(n.controlsSelectedClass).eq(t.selected).addClass(n.controlsSelectedClass);r.find("[data-replace-with=current]").text(t.selected+1);r.find("[data-replace-with=total]").text(t.total)},showSlide:function(t,n){var r=this,s=r.element,o=r.slides,u=r.data,a=r.options;var f=a.loop;var l=u.total-1;if(typeof n==="undefined")n=a.speed;t=t>l?f?0:l:t<0?f?l:0:t;if(!u.forced&&(u.moving||t==u.selected)){return}u.forced=false;u.moving=true;u.previous=u.selected;u.selected=t;u.speed=n;if(u.loopDir==0){u.loopDir=u.selected-u.previous>0?1:-1}u.selectedSlide=o.eq(u.selected);u.previousSlide=u.previous>=0?o.eq(u.previous).not(u.selectedSlide):e();u.otherSlides=o.not(u.selectedSlide).not(u.previousSlide);clearTimeout(u.timerChange);clearTimeout(u.timerTransition);o.removeClass(a.selectedSlideClass+" "+a.previousSlideClass);u.selectedSlide.addClass(a.selectedSlideClass);u.previousSlide.addClass(a.previousSlideClass);u.visualTimer.stop(true,false).animate({width:0,marginLeft:"100%"},{duration:u.speed});s.trigger("slidestart."+i);a.slidestart.call(r,s,o,a,u);u.timerTransition=setTimeout(function(){u.moving=false;if(u.playing){r.playSlides()}u.previousSlide.removeClass(a.previousSlideClass);s.trigger("slideend."+i);a.slideend.call(r,s,o,a,u)},u.speed)},showPrevious:function(){this.data.loopDir=-1;this.showSlide(this.data.selected-1)},showNext:function(){this.data.loopDir=1;this.showSlide(this.data.selected+1)},stopSlides:function(){var e=this,t=e.data,n=e.controls,r=e.options;if(n){n.playLink.addClass(r.controlsPausedClass);n.pauseLink.addClass(r.controlsPausedClass)}t.playing=false;t.forced=true;e.showSlide(t.selected,0)},playSlides:function(){var e=this,t=e.data,n=e.controls,r=e.options;if(n){n.playLink.removeClass(r.controlsPausedClass);n.pauseLink.removeClass(r.controlsPausedClass)}t.playing=true;t.visualTimer.stop(true,false).css({marginLeft:0}).animate({width:"100%"},{duration:r.timer});clearTimeout(t.timerChange);t.timerChange=setTimeout(function(){next=t.selected+1>t.total-1?0:t.selected+1;e.data.loopDir=1;e.showSlide(next)},r.timer)},createContainer:function(){var t=this.slides.parent();if(t.is(this.element)||t.length>1){t=e("<div>").appendTo(this.element).append(this.slides)}this.container=t;return this.container}};e.fn[i].transitions={fade:function(t,n,r,s){var o=this.createContainer();var u=100/s.total;t.css({overflow:"hidden"});o.css({position:"relative",left:0,top:0,width:s.total*100+"%"});n.css({position:"relative","float":"left",width:u+"%",zIndex:0,opacity:0,visibility:"hidden"}).each(function(t,n){e(this).css({left:u*-t+"%"})});t.on("slidestart."+i,function(){s.selectedSlide.css({zIndex:1,visibility:"visible"}).fadeTo(s.speed,1);setTimeout(function(){s.previousSlide.fadeTo(s.speed/2,0)},s.speed/2)}).on("slideend."+i,function(){s.selectedSlide.css({zIndex:0});s.previousSlide.css({visibility:"hidden"})})},scroll:function(e,t,n,r){function v(e,t){var n;if(r.csstransforms3d&&r.csstransitions){n=e/a*-100+"%";var i=l?"translate3d("+n+",0,0)":"translateX("+n+")";o.css({transform:i,"transition-duration":t+"ms"})}else{n=e*-100+"%";o.animate({left:n},{duration:t})}}var s=this;var o=s.createContainer();var u=t;var a=u.length;var f=false;var l=n.swipe&&r.touch;var c=n.loop&&!l;var h=r.touchData;if(c){var p=t.clone().prependTo(o);var d=t.clone().appendTo(o);u=u.add(p).add(d);a=u.length}if(e.css("position")=="static"){e.css("position","relative")}o.css({position:"relative",left:0,top:0,width:a*100+"%"});u.css({"float":"left",width:100/a+"%"});e.on("slidestart."+i,function(){var e=r.selected;f=false;if(c){e+=r.total;if((r.selected-r.previous)*r.loopDir<0){e+=r.total*r.loopDir;f=true}}v(e,r.speed)}).on("slideend."+i,function(){if(c&&f){var e=r.selected+r.total;v(e,0)}});if(l){e.on("touchstart."+i,function(){s.stopSlides()}).on("touchmove."+i,function(){if(!h.isVertical){var e=r.selected+h.swipeX/-h.resistance;v(e,0)}}).on("swipesuccess."+i,function(){var e=h.deltaX<0?1:-1;r.forced=true;s.showSlide(r.selected+e,n.speed)}).on("swipefail."+i,function(){v(r.selected,n.speed)})}}}})(jQuery,window)